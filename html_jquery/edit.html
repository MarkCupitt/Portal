<!DOCTYPE html>
<html>
<head>
<title>Edit</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="index.css">
<script src="js/jquery-2.0.3.js"></script>
<script src="js/util.js"></script>
</head>

<body>
<script>
var urlParams = util.getUrlParams();
var id = urlParams.id || '';
var data = {};

$(function() {
  var url = 'server/?details/id/'+ id;

  if (id) {
    $.getJSON(url, function(data_) {
      data = data_;
      $('.input').each(function(i, field) {
        field.value = data[field.name] || '';
      });
    });
  }

  $('#btn_save').click(function() {
    $('.input').each(function(i, field) {
      data[field.name] = field.value;
    });
    $.ajax({
      type: 'POST',
      url: url,
      data: data,
      dataType: 'json',
      success: function() {
        location.href = 'details.html?id='+ id;
      }
    });
  });

  $('#btn_cancel').click(function() {
    location.href = id ? 'details.html?id='+ id : 'index.html';
  });
});
</script>

<div id="content">
  <h1>Edit</h1>

  <form id="edit"><ul>
    <li><label>Title</label>
    <input name="title" class="input" type="text" maxlength="30"></li>

    <li><label>Description</label>
    <textarea name="descr" class="input" rows="5"></textarea></li>

    <li><label>Keywords</label>
    <input name="keywords" class="input" type="text" maxlength="30"></li>

    <li><label>Languages</label>
    <input name="lang" class="input" type="text" maxlength="30"></li>

    <li><label>Input-Format</label>
    <input name="input_format" class="input" type="text" maxlength="30"></li>

    <li><label>Date creation</label>
    <input name="date_creation" class="input" type="text" maxlength="30"></li>

    <li><label>Reference</label>
    <input name="url_reference" class="input" type="text" maxlength="30"></li>

    <li><label>URL data</label>
    <input name="url_data" class="input" type="text" maxlength="30"></li>

    <li><label>Up to date?</label>
    <input name="is_latest" class="input" type="text" maxlength="30"></li>

    <li><label>GetCapabilities</label>
    <input name="reference_data" class="input" type="text" maxlength="30"></li>

    <li><label>Input CRS</label>
    <input name="input_crs" class="input" type="text" maxlength="30"></li>

    <li><label>Geometry</label>
    <textarea name="geometry" class="input" rows="5"></textarea></li>
  </ul></form>

  <button id="btn_save" type="submit">Save</button>
  <button id="btn_cancel" type="button">Cancel</button>
</div>
</body>
</html>